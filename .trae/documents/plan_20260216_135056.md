I have integrated the "Juice & Polish", "Visual Feedback", and "Meta-Progression" requirements into the plan.

### **Phase 1: Core Systems & Graphics Engine**
**Goal:** Establish the "Juice" foundation and switch to a procedural graphics system (removing all sprites).

1.  **Refactor `effects.py`**:
    *   **ParticleManager:**
        *   Implement specific particle types: `DustParticle` (jump/land), `SquareParticle` (dash), `StarParticle` (super dash), `SpeedLineParticle` (super dash bg), `AfterimageParticle` (dash trail with fading opacity).
        *   Implement "Object Pooling" logic (or strict priority management) to handle the 200-particle limit.
    *   **EffectManager:**
        *   Implement Shake Types: `Impact` (random), `Directional` (vector-based), `Rumble` (continuous low-magnitude), `Freeze` (camera lock).
        *   Implement Time Control: `apply_slowmo` (0.3x for Perfect Parry, 0.5x for Boss Ultimate), `apply_freeze` (0.0x for Hit Stop).
        *   Implement Zoom: `apply_zoom` (Intro, Phase Change, Ultimate).

2.  **Refactor `utils.py`**:
    *   Remove `SpriteLoader`.
    *   Add `SoundManager` class to handle layered audio logic (logging/placeholder for now).

### **Phase 2: Player Overhaul (The "Feel")**
**Goal:** Implement the "Master" movement and combat with intense visual feedback.

1.  **Movement & Visuals (`player.py`)**:
    *   **Procedural Drawing:** Replace sprites with `pygame.draw`. Implement "Squash & Stretch" animation logic on jump/land.
    *   **Dash System:**
        *   **Standard:** 5 afterimages, white square particles, "Whoosh" sound.
        *   **Super Dash:** 8 afterimages, blue star particles, speed lines, double distance, enemy knockback.
        *   **Air Dash:** Implement 8-direction control and "Slam-Down" mechanics.
    *   **Jump:** Add dust particles on takeoff/landing and "Thud" sound based on fall height.

2.  **Parry 2.0 (`player.py`)**:
    *   **Perfect Parry:** 5-frame window triggers `EffectManager.apply_freeze(4)` + `apply_slowmo(0.3)`. Spawns gold sparks and "Freeze-Shake".
    *   **Streber Mode:** Implement the 3-chain trigger for 10s of infinite Gold Shots.

3.  **Weapons (`projectiles.py`)**:
    *   **Procedural Projectiles:**
        *   **Paper Ball:** Rotates in flight, white line trail, "crumple" animation on hit.
        *   **Paper Plane (EX):** Smooth sine-wave glide, blue paper-texture trail, fragments on hit.
    *   **New Weapons:** Implement `Spread Shot` (5x pew) and `Homing Shot` (tracking).
    *   **EX Mechanics:** Add "Catch" logic for Ruler and "Explosion" logic for Eraser.

### **Phase 3: Boss Evolution - Dr. Pythagoras 2.0**
**Goal:** Implement the 3-Phase structure with escalating chaos and "Personality".

1.  **Visuals (`boss.py`)**:
    *   Procedural drawing for the Boss (e.g., geometric shape with expressions).
    *   **Phase 1 (The Lesson):** Static, minimal movement.
    *   **Phase 2 (Reality Check):** Floating, angry color palette.
    *   **Phase 3 (Despair):** Glitching effect, dark red color, screen rumble.

2.  **Attacks (`boss.py` & `boss_projectiles.py`)**:
    *   **Phase 1:** "Advanced Geometry" (Burst), "Chaos Eraser" (2x sizes), "Chalk Wipe" (Pink Core).
    *   **Phase 2:** "Hard Eraser" (Dual-side), "Wave Rain" (Safe lanes), "Protractor Spin" (Pink Tips + Stun).
    *   **Phase 3:** "Compass Hell" (5 bursts + rotation), "Sweeping Laser", "Teleport Strike" (Melee).

3.  **Weak Point System:**
    *   Implement specific windows (Geometry Windup, Protractor Spin) where the Boss takes 2x/3x damage.
    *   Visual cue: Yellow pulsing outline/rect on the weak spot.

### **Phase 4: Meta-Progression & UI**
**Goal:** Reward mastery with the Grading System.

1.  **Grading System (`ui.py`, `main.py`)**:
    *   Implement `GradeScreen` with the formula: `Score = (Time*0.3) + (Damage*0.3) + (Parries*0.2) + (Style*0.2)`.
    *   Track "Style Events" (Perfect Dashes, Weak Point Hits) in `Game` class.
    *   Display detailed stats post-game.

2.  **HUD Updates (`ui.py`)**:
    *   Add "Golden" animation for Perfect Parry cards.
    *   Add pulsing effect for full Ultimate meter.

I will begin by refactoring the Core Systems (`effects.py`) to support the new "Juice" requirements.
